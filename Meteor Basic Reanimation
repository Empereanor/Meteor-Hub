-- Physics

settings().Physics.AllowSleep = false
settings().Physics.DisableCSGv2 = true
settings().Physics.PhysicsEnvironmentalThrottle = Enum.EnviromentalPhysicsThrottle.Disabled

-- Variables

local Player = game.Players.LocalPlayer
local Character = Player.Character
local Humanoid = Character:FindFirstChildOfClass("Humanoid")

-- Rig Body

local Dummy = game:GetObjects("rbxassetid://9528321252")[1]

-- Rig Settings 

Dummy.Parent = Character
Dummy.Name = "Dummy"

Dummy:MoveTo(Character["HumanoidRootPart"].Position)

-- Character 

Character.Archivable = true

Character["HumanoidRootPart"].Anchored = true

if Character:FindFirstChild("Animate") then
    Character.Animate.Disabled = true 
end

-- Anti Ragdoll

for _,RagdollConstraint in pairs(Character:GetDescendants()) do
    if RagdollConstraint:IsA("BallSocketConstraint") or RagdollConstraint:IsA("HingeConstraint") then
        RagdollConstraint:Destroy()
    end
end

-- Animations

for _,anims in next, Humanoid:GetPlayingAnimationTracks() do
  anims:Stop()
end

-- Humanoid

if Humanoid:FindFirstChild("Animator") then
    Humanoid.Animator:remove() 
end

Humanoid:ChangeState(16)

Humanoid.WalkSpeed = 0 
Humanoid.JumpPower = 0 

Humanoid.AutoRotate = false
Humanoid.AutoJumpEnabled = false

-- Shortcuts

local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- No-Clip

Humanoid:ChangeState(11)

local NoclipConnection; NoclipConnection = RunService.Stepped:Connect(function()
    if not Character:IsDescendantOf(game) or not Dummy:IsDescendantOf(game) then
        NoclipConnection:Disconnect()
        
        return
    end
    
    for _, Object in pairs(Character:GetChildren()) do
        if Object:IsA("BasePart") then
            Object.CanCollide = false
        end
    end
end)

for _,b in pairs(Dummy:GetChildren()) do
    if b:IsA("Part") or b:IsA("BasePart") then
        b.CanCollide = false
    end
end

game:GetService("UserInputService").JumpRequest:Connect(function()
    Dummy.Humanoid.Sit = false
    Dummy.Humanoid.Jump = true
end)

-- Functions

function Align(Part1, Part2, Pos, Angle)
    Part1.CFrame = Part2.CFrame * CFrame.new(Pos) * CFrame.new(0, 0, 0) * Angle or Part2.CFrame * CFrame.new(Vector3.new(0, 0, 0)) * CFrame.new(0, 0, 0) * CFrame.Angles(0, 0, 0)
    Part1.CFrame = Part1.CFrame:Lerp(Part2.CFrame * CFrame.new(Pos) * Angle or Part2.CFrame * CFrame.new(Vector3.new(0, 0, 0)) * CFrame.Angles(0, 0, 0), .3)
end

function LoadLibrary()
    return loadstring(game:HttpGet("https://pastebin.com/raw/UfzKgS6T", true))()
end

-- Dummy

for _,v in pairs(Dummy:GetDescendants()) do
    if v:IsA("Part") or v:IsA("BasePart") or v:IsA("Decal") then 
        v.Transparency = 1
    end
end

-- Velocity

for _,Net in pairs(Character:GetChildren()) do
    if Net:IsA("BasePart") or Net:IsA("MeshPart") then
        spawn(function()
            while task.wait(1-1) do
                Net.Velocity = Vector3.new(-30, -30, -30)
            end
        end)
    end
end

-- Body Velocity

for _,bv in pairs(Character:GetChildren()) do
    if bv:IsA("BasePart") or bv:IsA("MeshPart") then
        local BV = Instance.new("BodyVelocity");BV.Parent = bv;BV.MaxForce = Vector3.new(0, 0, 0);BV.Name = "Meteor";
        BV.Velocity = Vector3.new(0, 0, 0)
    end
end

-- R6

if Humanoid.RigType == Enum.HumanoidRigType.R6 then
    
    -- Joints
    
    Character["Right Arm"]:BreakJoints()
    Character["Right Leg"]:BreakJoints()
    Character["Left Arm"]:BreakJoints()
    Character["Left Leg"]:BreakJoints()
    
    Character["HumanoidRootPart"]:Destroy()
    
    -- Align
    
    spawn(function()
        while task.wait(1-1) do
            Align(Character["Right Arm"], Character.Dummy["Right Arm"], Vector3.new(0, 0.01, 0), CFrame.Angles(0 ,0 ,0))
            Align(Character["Left Arm"], Character.Dummy["Left Arm"], Vector3.new(0, 0.01, 0), CFrame.Angles(0 ,0 ,0))
            Align(Character["Right Leg"], Character.Dummy["Right Leg"], Vector3.new(0, 0.01, 0), CFrame.Angles(0 ,0 ,0))
            Align(Character["Left Leg"], Character.Dummy["Left Leg"], Vector3.new(0, 0.01, 0), CFrame.Angles(0 ,0 ,0))
            Align(Character["Torso"], Character.Dummy["Torso"], Vector3.new(0, 0.01, 0), CFrame.Angles(0 ,0 ,0))
            Align(Character["Head"], Character.Dummy["Head"], Vector3.new(0, 0.01, 0), CFrame.Angles(0 ,0 ,0))
        end
    end)
    
elseif Humanoid.RigType == Enum.HumanoidRigType.R15 then
    
    -- Joints 
    
    Character["RightUpperArm"]:BreakJoints()
    Character["RightLowerArm"]:BreakJoints()
    Character["RightHand"]:BreakJoints()
    Character["LeftUpperArm"]:BreakJoints()
    Character["LeftLowerArm"]:BreakJoints()
    Character["LeftHand"]:BreakJoints()
    Character["RightUpperLeg"]:BreakJoints()
    Character["RightLowerLeg"]:BreakJoints()
    Character["RightFoot"]:BreakJoints()
    Character["LeftUpperLeg"]:BreakJoints()
    Character["LeftLowerLeg"]:BreakJoints()
    Character["LeftFoot"]:BreakJoints()
    Character["HumanoidRootPart"]:remove()
    Character.UpperTorso.Waist:remove()
    Character.LowerTorso.Root:remove()


    -- Align 
   
   spawn(function()
       while task.wait(1-1) do
            Align(Character["RightUpperArm"], Dummy["Right Arm"], Vector3.new(0,0.36867332458496094,0), CFrame.Angles(0, 0, 0))
            Align(Character["RightLowerArm"], Dummy["Right Arm"], Vector3.new(0,-0.22407126426696777,0), CFrame.Angles(0, 0, 0))
            Align(Character["RightHand"], Dummy["Right Arm"], Vector3.new(0,-0.8500454425811768,0), CFrame.Angles(0, 0, 0))

            Align(Character["LeftUpperArm"], Dummy["Left Arm"], Vector3.new(0,0.36867332458496094,0), CFrame.Angles(0, 0, 0))
            Align(Character["LeftLowerArm"], Dummy["Left Arm"], Vector3.new(0,-0.22407126426696777,0), CFrame.Angles(0, 0, 0))
            Align(Character["LeftHand"], Dummy["Left Arm"], Vector3.new(0,-0.8500454425811768,0), CFrame.Angles(0, 0, 0))

            Align(Character["RightUpperLeg"], Dummy["Right Leg"], Vector3.new(0,0.5792183876037598,0), CFrame.Angles(0, 0, 0))
            Align(Character["RightLowerLeg"], Dummy["Right Leg"], Vector3.new(0,-0.20090234279632568,0), CFrame.Angles(0, 0, 0))
            Align(Character["RightFoot"], Dummy["Right Leg"], Vector3.new(0,-0.8499990701675415,0), CFrame.Angles(0, 0, 0))

            Align(Character["LeftUpperLeg"], Dummy["Left Leg"], Vector3.new(0,0.5792183876037598,0), CFrame.Angles(0, 0, 0))
            Align(Character["LeftLowerLeg"], Dummy["Left Leg"], Vector3.new(0,-0.20090234279632568,0), CFrame.Angles(0, 0, 0))
            Align(Character["LeftFoot"], Dummy["Left Leg"], Vector3.new(0,-0.8499990701675415,0), CFrame.Angles(0, 0, 0))

            Align(Character.UpperTorso, Dummy.Torso, Vector3.new(0, 0.1999831199645996, 0), CFrame.Angles(0, 0, 0))
            Align(Character.LowerTorso, Dummy.Torso, Vector3.new(0, -0.8000273704528809, 0), CFrame.Angles(0, 0, 0))
        end
    end)
    
end

-- Character Set 

game.Players.LocalPlayer.Character = Dummy

-- Camera Fix

workspace.CurrentCamera.CameraSubject = Dummy.Humanoid

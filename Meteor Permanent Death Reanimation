-- Note for Charlie / Dont change align code JUST FIX IT FLYNG AWAYYY :sob: /

-- Physics:

settings().Physics.AllowSleep = false
settings().Physics.DisableCSGv2 = true
settings().Physics.PhysicsEnvironmentalThrottle = Enum.EnviromentalPhysicsThrottle.Disabled

-- Simulation Radius:

game:GetService("RunService").RenderStepped:Connect(function()
    setscriptable(game.Players.LocalPlayer, "SimulationRadius", true)
    sethiddenproperty(game.Players.LocalPlayer, "MaximumSimulationRadius", math.huge)
    sethiddenproperty(game.Players.LocalPlayer, "SimulationRadius", math.huge)
end)

-- Variables:

local Workspace = game:GetService("Workspace") and workspace
local Player = game:GetService("Players").LocalPlayer
local Name = Player.Name
local Character = Player.Character or Workspace[Name]
local Root = Character.HumanoidRootPart
local Humanoid = Character:FindFirstChildWhichIsA("Humanoid")
local PhysicsService = game:GetService("PhysicsService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Humanoid Settings:

for _,Animations in next, Humanoid:GetPlayingAnimationTracks() do
    Animations:Stop()
end

if Humanoid:FindFirstChild("Animator") then
    Humanoid.Animator:Destroy()
end

Humanoid:ChangeState(16)

Humanoid.WalkSpeed = 0 
Humanoid.JumpPower = 0 

Humanoid.AutoRotate = false
Humanoid.AutoJumpEnabled = false

-- Rig Body:

local Dummy = game:GetObjects("rbxassetid://9570701779")[1] -- phere's RigBody

Dummy.Parent = Workspace
Dummy.Name = "MeteorReanimate"

Dummy:MoveTo(Root.Position)

-- Invisible Rig Body:

for _,Invisible in pairs(Dummy:GetDescendants()) do
    if Invisible:IsA("BasePart") or Invisible:IsA("Decal") or Invisible:IsA("ForceField") then
        Invisible.Transparency = 1
    end
end

-- Character Settings:

Character.Archivable = true -- Just in Case

if Character:FindFirstChild("Animate") then
    Character.Animate:Destroy()
end

-- Updating Variables:

Character.Parent = Dummy

local Character = Dummy
local RealCharacter = Character[Name]

-- Permanent Death:

game.Players.LocalPlayer.Character = nil
game.Players.LocalPlayer.Character = Dummy

wait(game.Players.RespawnTime + .35)

task.spawn(function()
    for _,Permanent in pairs(RealCharacter:GetDescendants()) do
        if Permanent:IsA("Motor6D") or Permanent:IsA("Weld") or Permanent:IsA("BallSocketConstraint") or Permanent:IsA("HingeConstraint") then
            Permanent:Destroy()
        end
    end
end)

-- Anchor:

for _,Anchor in pairs(Dummy:GetChildren()) do
    if Anchor:IsA("BasePart") then
        Anchor.Anchored = true
    end
end

-- Functions:

function Align(Part1, Part2, Pos, Angle)
    Part1.CFrame = Part2.CFrame *Pos *Angle
end

function LoadLibrary() -- phere's LoadLibrary
    return loadstring(game:HttpGet("https://pastebin.com/raw/UfzKgS6T", true))()
end

-- No-Clip:

loadstring(game:HttpGet("https://raw.githubusercontent.com/LegoHacker1337/legohacks/main/PhysicsServiceOnClient.lua"))()

if not pcall(function() PhysicsService:GetCollisionGroupId("NoCollide") end) then 
    PhysicsService:CreateCollisionGroup("NoCollide")
    PhysicsService:CollisionGroupSetCollidable("NoCollide", "NoCollide", false)
end

for _,NoClip in pairs(Dummy:GetDescendants()) do
    if NoClip:IsA("BasePart") then
        PhysicsService:SetPartCollisionGroup(NoClip, "NoCollide")
    end
end

local NoclipConnection; NoclipConnection = RunService.Stepped:Connect(function()
    if not Character:IsDescendantOf(game) or not Dummy:IsDescendantOf(game) then
        NoclipConnection:Disconnect()
        return
    end
    
    for _, Object in pairs(Dummy:GetChildren()) do
        if Object:IsA("BasePart") then
            Object.CanCollide = false
        end
    end
end)

-- Align Section:

if Humanoid.RigType == Enum.HumanoidRigType.R6 then -- R6 RigBody
    
    -- Velocity:

    for _,Netless in pairs(RealCharacter:GetChildren()) do
        if Netless:IsA("BasePart") then
            spawn(function()
                while task.wait(1-1) do
                    Netless.Velocity = Vector3.new(100, -0, -0)
                end
            end)
        end
    end
    
    -- Align Limbs:
    
    spawn(function()
        while task.wait() do
            Align(RealCharacter["Head"], Character["Head"], CFrame.new(0.01, 0.01, 0.01), CFrame.Angles(0.01, 0.01, 0.01))
            Align(RealCharacter["Torso"], Character["Torso"], CFrame.new(0.01, 0.01, 0.01), CFrame.Angles(0.01, 0.01, 0.01))
            Align(RealCharacter["HumanoidRootPart"], Dummy["HumanoidRootPart"], CFrame.new(0.01, 0.01, 0.01), CFrame.new(0.01, 0.01, 0.01))
            Align(RealCharacter["Right Arm"], Character["Right Arm"], CFrame.new(0.01, 0.01, 0.01), CFrame.Angles(0.01, 0.01, 0.01))
            Align(RealCharacter["Left Arm"], Character["Left Arm"], CFrame.new(0.01, 0.01, 0.01), CFrame.Angles(0.01, 0.01, 0.01))
            Align(RealCharacter["Right Leg"], Character["Right Leg"], CFrame.new(0.01, 0.01, 0.01), CFrame.Angles(0.01, 0.01, 0.01))
            Align(RealCharacter["Left Leg"], Character["Left Leg"], CFrame.new(0.01, 0.01, 0.01), CFrame.Angles(0.01, 0.01, 0.01))
        end
    end)
    
elseif Humanoid.RigType == Enum.HumanoidRigType.R15 then -- R15 RigBody
    
    -- Velocity:

    for _,Netless in pairs(RealCharacter:GetChildren()) do
        if Netless:IsA("BasePart") then
            spawn(function()
                while task.wait(1-1) do
                    Netless.Velocity = Vector3.new(-0, -0, -55)
                end
            end)
        end
    end
    
    -- Align:
   
   spawn(function()
       while task.wait(1-1) do
            Align(RealCharacter["RightUpperArm"], Dummy["Right Arm"], CFrame.new(0,0.36867332458496094,0), CFrame.Angles(0,0,0))
            Align(RealCharacter["RightLowerArm"], Dummy["Right Arm"], CFrame.new(0,-0.22407126426696777,0), CFrame.Angles(0, 0, 0))
            Align(RealCharacter["RightHand"], Dummy["Right Arm"], CFrame.new(0,-0.8500454425811768,0), CFrame.Angles(0, 0, 0))

            Align(RealCharacter["LeftUpperArm"], Dummy["Left Arm"], CFrame.new(0,0.36867332458496094,0), CFrame.Angles(0, 0, 0))
            Align(RealCharacter["LeftLowerArm"], Dummy["Left Arm"], CFrame.new(0,-0.22407126426696777,0), CFrame.Angles(0, 0, 0))
            Align(RealCharacter["LeftHand"], Dummy["Left Arm"], CFrame.new(0,-0.8500454425811768,0), CFrame.Angles(0, 0, 0))

            Align(RealCharacter["RightUpperLeg"], Dummy["Right Leg"], CFrame.new(0,0.5792183876037598,0), CFrame.Angles(0, 0, 0))
            Align(RealCharacter["RightLowerLeg"], Dummy["Right Leg"], CFrame.new(0,-0.20090234279632568,0), CFrame.Angles(0, 0, 0))
            Align(RealCharacter["RightFoot"], Dummy["Right Leg"], CFrame.new(0,-0.8499990701675415,0), CFrame.Angles(0, 0, 0))

            Align(RealCharacter["LeftUpperLeg"], Dummy["Left Leg"], CFrame.new(0,0.5792183876037598,0), CFrame.Angles(0, 0, 0))
            Align(RealCharacter["LeftLowerLeg"], Dummy["Left Leg"], CFrame.new(0,-0.20090234279632568,0), CFrame.Angles(0, 0, 0))
            Align(RealCharacter["LeftFoot"], Dummy["Left Leg"], CFrame.new(0,-0.8499990701675415,0), CFrame.Angles(0, 0, 0))

            Align(RealCharacter["HumanoidRootPart"], Dummy.HumanoidRootPart, CFrame.new(0.01, 0.01, 0.01), CFrame.new(0.01, 0.01, 0.01))
            Align(RealCharacter["UpperTorso"], Dummy.Torso, CFrame.new(0, 0.1999831199645996, 0), CFrame.Angles(0, 0, 0))
            Align(RealCharacter["LowerTorso"], Dummy.Torso, CFrame.new(0, -0.8000273704528809, 0), CFrame.Angles(0, 0, 0))
            
            Align(RealCharacter["Head"], Dummy["Head"], CFrame.new(0, 0, 0), CFrame.Angles(0, 0, 0))
        end
    end)
    
else
    error("What rig are u fucking using bro?")
end

-- Un Anchor:

for _,UnAnchor in pairs(Dummy:GetChildren()) do
    if UnAnchor:IsA("BasePart") then
        UnAnchor.Anchored = false
    end
end

-- Camera:

workspace.CurrentCamera.CameraSubject = Dummy.Humanoid
